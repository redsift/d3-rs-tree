<html>
  <head>
    <link rel="stylesheet" type="text/css" href="https://static.redsift.io/reusable/ui-rs-core/latest/css/ui-rs-core.min.css">
    <style>
    @import url(https://fonts.googleapis.com/css?family=Source+Code+Pro:300,500);  
    body {
      margin: 1em;
    }
    div#options {
      margin-bottom: 1em;
    }
    div#elm {
      position: relative;
      text-align: center;
    }
    div#zoom {
      position: absolute;
      right: 0;
      top: 0;
    }
    div#zoom button {
      font-weight: 800;
    }    
    text.ip-addr {
      font-family: "Source Code Pro", Consolas, "Liberation Mono", Menlo, Courier, monospace;
    }
    text.badge {
      font-family: "Source Code Pro", Consolas, "Liberation Mono", Menlo, Courier, monospace;
      font-weight: 500;  
      fill: #aaa;
      font-size: 0.75em;
    }
    div.d3-tip > div:first-child {
        padding: 0 0 0.75em 0;
    }
    div.d3-tip > div:first-child:after {
        content: "";
        background-color: #fff;
        width: 100%;
        height: 2px;
        top: 0.38em;
        position: relative;
        display: block;
    }

    </style> 
  </head>
  <body>
    <div id="options">
      <button onclick="doSortId()">Default</button>  
      <button onclick="doSort('subnetCount')">Sort: Subnet Size</button>  
      <button onclick="doSort('rfc7208DnsCount')">Sort: DNS Lookups (RFC-7208)</button>  
      <button onclick="doSort('rfc4408DnsCount')">Sort: DNS Lookups (RFC-4408)</button>  
    </div>
    <div id="elm">
          <div id="zoom">
            <button onclick="doExpandIncrement()">+</button>   
            <button onclick="doCollapseDecrement()">-</button>       
          </div>
    </div>
        
    <script src="https://d3js.org/d3.v4.min.js"></script>
    <script src="//static.redsift.io/reusable/d3-rs-theme/latest/d3-rs-theme.umd-es2015.min.js"></script>
    <script src="/d3-rs-tree.umd-es2015.min.js"></script>
    <script>

    'use strict';
    var TEST_31 = {
    "id": 1,
    "effectiveValue": "test31.irkov.co.uk.",
    "raw": "v=spf1 a/24/64 ~all",
    "children": [
        {
            "id": 2,
            "qualifier": "+",
            "mechanism": "a",
            "value": "/24/64",
            "effectiveValue": "test31.irkov.co.uk.",
            "children": [
                {
                    "id": 3,
                    "mechanism": "ip4",
                    "effectiveValue": "217.160.0.212/24",
                    "rfc7208DnsCount": 1,
                    "subnetCount": 254,
                    "subnetBits": 8
                },
                {
                    "id": 4,
                    "mechanism": "ip6",
                    "effectiveValue": "2001:8d8:100f:f000::29d/64",
                    "rfc7208DnsCount": 1,
                    "subnetCount": 18446744073709551615,
                    "subnetBits": 64
                }
            ],
            "rfc4408DnsCount": 1,
            "rfc7208DnsCount": 1
        },
        {
            "id": 5,
            "qualifier": "~",
            "mechanism": "all"
        }
    ]
};
    var TEST_1 = {
		    "id": 1,
		    "effectiveValue": "test1.irkov.co.uk.",
		    "raw": "v=spf1 include:bmsend.com ?all include:mail.zendesk.com include:servers.mcsv.net -all include:_spf.perfora.net include:_spf.kundenserver.de include:_spf.google.com ~all",
		    "children": [
		        {
		            "id": 2,
		            "qualifier": "+",
		            "mechanism": "include",
		            "value": "bmsend.com",
		            "effectiveValue": "bmsend.com.",
		            "raw": "v=spf1 +ip4:207.8.96.0/23 +ip4:38.95.104.0/23 +ip4:38.126.54.0/24 +ip4:216.4.238.0/24 +ip4:12.174.236.0/24 +ip4:12.206.206.0/24 +ip4:12.110.193.0/25 +ip4:38.107.205.0/25 +ip4:216.151.221.128/26 +ip4:74.205.79.233 ~all",
		            "children": [
		                {
		                    "id": 3,
		                    "qualifier": "+",
		                    "mechanism": "ip4",
		                    "value": "207.8.96.0/23",
		                    "effectiveValue": "207.8.96.0/23",
		                    "subnetCount": 510
		                },
		                {
		                    "id": 4,
		                    "qualifier": "+",
		                    "mechanism": "ip4",
		                    "value": "38.95.104.0/23",
		                    "effectiveValue": "38.95.104.0/23",
		                    "subnetCount": 510
		                },
		                {
		                    "id": 5,
		                    "qualifier": "+",
		                    "mechanism": "ip4",
		                    "value": "38.126.54.0/24",
		                    "effectiveValue": "38.126.54.0/24",
		                    "subnetCount": 254
		                },
		                {
		                    "id": 6,
		                    "qualifier": "+",
		                    "mechanism": "ip4",
		                    "value": "216.4.238.0/24",
		                    "effectiveValue": "216.4.238.0/24",
		                    "subnetCount": 254
		                },
		                {
		                    "id": 7,
		                    "qualifier": "+",
		                    "mechanism": "ip4",
		                    "value": "12.174.236.0/24",
		                    "effectiveValue": "12.174.236.0/24",
		                    "subnetCount": 254
		                },
		                {
		                    "id": 8,
		                    "qualifier": "+",
		                    "mechanism": "ip4",
		                    "value": "12.206.206.0/24",
		                    "effectiveValue": "12.206.206.0/24",
		                    "subnetCount": 254
		                },
		                {
		                    "id": 9,
		                    "qualifier": "+",
		                    "mechanism": "ip4",
		                    "value": "12.110.193.0/25",
		                    "effectiveValue": "12.110.193.0/25",
		                    "subnetCount": 126
		                },
		                {
		                    "id": 10,
		                    "qualifier": "+",
		                    "mechanism": "ip4",
		                    "value": "38.107.205.0/25",
		                    "effectiveValue": "38.107.205.0/25",
		                    "subnetCount": 126
		                },
		                {
		                    "id": 11,
		                    "qualifier": "+",
		                    "mechanism": "ip4",
		                    "value": "216.151.221.128/26",
		                    "effectiveValue": "216.151.221.128/26",
		                    "subnetCount": 62
		                },
		                {
		                    "id": 12,
		                    "qualifier": "+",
		                    "mechanism": "ip4",
		                    "value": "74.205.79.233",
		                    "effectiveValue": "74.205.79.233",
		                    "subnetCount": 1
		                },
		                {
		                    "id": 13,
		                    "qualifier": "~",
		                    "mechanism": "all"
		                }
		            ],
		            "rfc4408DnsCount": 1,
		            "rfc7208DnsCount": 1
		        },
		        {
		            "id": 14,
		            "qualifier": "?",
		            "mechanism": "all"
		        },
		        {
		            "id": 15,
		            "qualifier": "+",
		            "mechanism": "include",
		            "value": "mail.zendesk.com",
		            "rfc4408DnsCount": 1,
		            "rfc7208DnsCount": 1,
		            "errors": [
		                {
		                    "error": "spf-directive-unused"
		                }
		            ]
		        },
		        {
		            "id": 16,
		            "qualifier": "+",
		            "mechanism": "include",
		            "value": "servers.mcsv.net",
		            "rfc4408DnsCount": 1,
		            "rfc7208DnsCount": 1,
		            "errors": [
		                {
		                    "error": "spf-directive-unused"
		                }
		            ]
		        },
		        {
		            "id": 17,
		            "qualifier": "-",
		            "mechanism": "all"
		        },
		        {
		            "id": 18,
		            "qualifier": "+",
		            "mechanism": "include",
		            "value": "_spf.perfora.net",
		            "rfc4408DnsCount": 1,
		            "rfc7208DnsCount": 1,
		            "errors": [
		                {
		                    "error": "spf-directive-unused"
		                }
		            ]
		        },
		        {
		            "id": 19,
		            "qualifier": "+",
		            "mechanism": "include",
		            "value": "_spf.kundenserver.de",
		            "rfc4408DnsCount": 1,
		            "rfc7208DnsCount": 1,
		            "errors": [
		                {
		                    "error": "spf-directive-unused"
		                }
		            ]
		        },
		        {
		            "id": 20,
		            "qualifier": "+",
		            "mechanism": "include",
		            "value": "_spf.google.com",
		            "rfc4408DnsCount": 1,
		            "rfc7208DnsCount": 1,
		            "errors": [
		                {
		                    "error": "spf-directive-unused"
		                }
		            ]
		        },
		        {
		            "id": 21,
		            "qualifier": "~",
		            "mechanism": "all"
		        }
		    ],
		    "errors": [
		        {
		            "error": "spf-unexpected-result-neutral"
		        }
		    ]
		};

    var FUGRO = {
    "raw": "v=spf1 include:_spf.salesforce.com include:amazonses.com ip4:46.34.88.128/25  ip4:37.74.5.32/29 ip4:95.138.138.252/32 ip4:85.17.187.192/27 ip4:95.211.74.192/27 ip4:62.204.93.128/27 ip4:83.149.98.0/26 ip4:85.17.205.0/27 ~all",
    "host": "fugro.com.",
    "children": [
        {
            "qualifier": "+",
            "mechanism": "include",
            "value": "_spf.salesforce.com",
            "raw": "v=spf1 exists:%{i}._spf.mta.salesforce.com -all",
            "host": "_spf.salesforce.com.",
            "children": [
                {
                    "qualifier": "+",
                    "mechanism": "exists",
                    "value": "%{i}._spf.mta.salesforce.com",
                    "macro": true,
                    "rfc4408DnsCount": 1,
                    "rfc7208DnsCount": 1
                },
                {
                    "qualifier": "-",
                    "mechanism": "all"
                }
            ],
            "rfc4408DnsCount": 1,
            "rfc7208DnsCount": 1
        },
        {
            "qualifier": "+",
            "mechanism": "include",
            "value": "amazonses.com",
            "raw": "v=spf1 ip4:199.255.192.0/22 ip4:199.127.232.0/22 ip4:54.240.0.0/18 -all",
            "host": "amazonses.com.",
            "children": [
                {
                    "qualifier": "+",
                    "mechanism": "ip4",
                    "value": "199.255.192.0/22",
                    "subnetCount": 1024
                },
                {
                    "qualifier": "+",
                    "mechanism": "ip4",
                    "value": "199.127.232.0/22",
                    "subnetCount": 1024
                },
                {
                    "qualifier": "+",
                    "mechanism": "ip4",
                    "value": "54.240.0.0/18",
                    "subnetCount": 16384
                },
                {
                    "qualifier": "-",
                    "mechanism": "all"
                }
            ],
            "rfc4408DnsCount": 1,
            "rfc7208DnsCount": 1
        },
        {
            "qualifier": "+",
            "mechanism": "ip4",
            "value": "46.34.88.128/25",
            "subnetCount": 128
        },
        {
            "qualifier": "+",
            "mechanism": "ip4",
            "value": "37.74.5.32/29",
            "subnetCount": 8
        },
        {
            "qualifier": "+",
            "mechanism": "ip4",
            "value": "95.138.138.252/32",
            "subnetCount": 1
        },
        {
            "qualifier": "+",
            "mechanism": "ip4",
            "value": "85.17.187.192/27",
            "subnetCount": 32
        },
        {
            "qualifier": "+",
            "mechanism": "ip4",
            "value": "95.211.74.192/27",
            "subnetCount": 32
        },
        {
            "qualifier": "+",
            "mechanism": "ip4",
            "value": "62.204.93.128/27",
            "subnetCount": 32
        },
        {
            "qualifier": "+",
            "mechanism": "ip4",
            "value": "83.149.98.0/26",
            "subnetCount": 64
        },
        {
            "qualifier": "+",
            "mechanism": "ip4",
            "value": "85.17.205.0/27",
            "subnetCount": 32
        },
        {
            "qualifier": "~",
            "mechanism": "all"
        }
    ]
};

var SUBITO =  {
		    "id": 1,
		    "effectiveValue": "subito.it.",
		    "raw": "v=spf1 mx:blocket.se include:spf.mailjet.com include:servers.mcsv.net ip4:109.168.127.160/27 ip4:212.31.252.64/27 ip4:212.77.68.6 ip4:62.212.1.160 ip4:62.212.0.160 ip4:93.94.32.0/21 ip4:93.94.37.253 ip4:109.168.121.48/28 ip4:37.202.20.23/32 ip4:213.215.152.254/32 ip4:213.215.152.253/32 ip4:213.215.152.252/32 ip4:213.215.152.251/32 ip4:109.168.121.54/32 ip4:109.168.121.55/32 ip4:109.168.121.57/32 ip4:109.168.121.58/32 -all",
		    "children": [
		        {
		            "id": 2,
		            "qualifier": "+",
		            "mechanism": "mx",
		            "value": "blocket.se",
		            "effectiveValue": "blocket.se.",
		            "children": [
		                {
		                    "id": 3,
		                    "mechanism": "a",
		                    "effectiveValue": "alt2.aspmx.l.google.com.",
		                    "children": [
		                        {
		                            "id": 4,
		                            "mechanism": "ip4",
		                            "effectiveValue": "74.125.200.26",
		                            "rfc7208DnsCount": 1,
		                            "subnetCount": 1
		                        },
		                        {
		                            "id": 10,
		                            "mechanism": "ip6",
		                            "effectiveValue": "2404:6800:4003:c00::1b",
		                            "rfc7208DnsCount": 1,
		                            "subnetCount": 1
		                        }
		                    ]
		                },
		                {
		                    "id": 5,
		                    "mechanism": "a",
		                    "effectiveValue": "alt1.aspmx.l.google.com.",
		                    "children": [
		                        {
		                            "id": 6,
		                            "mechanism": "ip4",
		                            "effectiveValue": "173.194.221.26",
		                            "rfc7208DnsCount": 1,
		                            "subnetCount": 1
		                        },
		                        {
		                            "id": 7,
		                            "mechanism": "ip6",
		                            "effectiveValue": "2a00:1450:4010:c0a::1a",
		                            "rfc7208DnsCount": 1,
		                            "subnetCount": 1
		                        }
		                    ]
		                },
		                {
		                    "id": 8,
		                    "mechanism": "a",
		                    "effectiveValue": "aspmx.l.google.com.",
		                    "children": [
		                        {
		                            "id": 9,
		                            "mechanism": "ip4",
		                            "effectiveValue": "74.125.133.26",
		                            "rfc7208DnsCount": 1,
		                            "subnetCount": 1
		                        },
		                        {
		                            "id": 16,
		                            "mechanism": "ip6",
		                            "effectiveValue": "2a00:1450:400c:c06::1b",
		                            "rfc7208DnsCount": 1,
		                            "subnetCount": 1
		                        }
		                    ]
		                },
		                {
		                    "id": 11,
		                    "mechanism": "a",
		                    "effectiveValue": "aspmx2.googlemail.com.",
		                    "children": [
		                        {
		                            "id": 12,
		                            "mechanism": "ip4",
		                            "effectiveValue": "173.194.221.26",
		                            "rfc7208DnsCount": 1,
		                            "subnetCount": 1
		                        },
		                        {
		                            "id": 17,
		                            "mechanism": "ip6",
		                            "effectiveValue": "2a00:1450:4010:c0a::1b",
		                            "rfc7208DnsCount": 1,
		                            "subnetCount": 1
		                        }
		                    ]
		                },
		                {
		                    "id": 13,
		                    "mechanism": "a",
		                    "effectiveValue": "aspmx3.googlemail.com.",
		                    "children": [
		                        {
		                            "id": 14,
		                            "mechanism": "ip6",
		                            "effectiveValue": "2404:6800:4003:c00::1b",
		                            "rfc7208DnsCount": 1,
		                            "subnetCount": 1
		                        },
		                        {
		                            "id": 15,
		                            "mechanism": "ip4",
		                            "effectiveValue": "74.125.200.26",
		                            "rfc7208DnsCount": 1,
		                            "subnetCount": 1
		                        }
		                    ]
		                }
		            ],
		            "rfc4408DnsCount": 1,
		            "rfc7208DnsCount": 1
		        },
		        {
		            "id": 18,
		            "qualifier": "+",
		            "mechanism": "include",
		            "value": "spf.mailjet.com",
		            "effectiveValue": "spf.mailjet.com.",
		            "raw": "v=spf1 ip4:178.33.111.144 ip4:178.33.137.208/28 ip4:178.33.221.0/24 ip4:37.59.69.128/25 ip4:37.59.249.0/24 ip4:87.253.232.0/21 ip4:185.189.236.0/22 ?all",
		            "children": [
		                {
		                    "id": 19,
		                    "qualifier": "+",
		                    "mechanism": "ip4",
		                    "value": "178.33.111.144",
		                    "effectiveValue": "178.33.111.144",
		                    "subnetCount": 1
		                },
		                {
		                    "id": 20,
		                    "qualifier": "+",
		                    "mechanism": "ip4",
		                    "value": "178.33.137.208/28",
		                    "effectiveValue": "178.33.137.208/28",
		                    "subnetCount": 14,
		                    "subnetBits": 4
		                },
		                {
		                    "id": 21,
		                    "qualifier": "+",
		                    "mechanism": "ip4",
		                    "value": "178.33.221.0/24",
		                    "effectiveValue": "178.33.221.0/24",
		                    "subnetCount": 254,
		                    "subnetBits": 8
		                },
		                {
		                    "id": 22,
		                    "qualifier": "+",
		                    "mechanism": "ip4",
		                    "value": "37.59.69.128/25",
		                    "effectiveValue": "37.59.69.128/25",
		                    "subnetCount": 126,
		                    "subnetBits": 7
		                },
		                {
		                    "id": 23,
		                    "qualifier": "+",
		                    "mechanism": "ip4",
		                    "value": "37.59.249.0/24",
		                    "effectiveValue": "37.59.249.0/24",
		                    "subnetCount": 254,
		                    "subnetBits": 8
		                },
		                {
		                    "id": 24,
		                    "qualifier": "+",
		                    "mechanism": "ip4",
		                    "value": "87.253.232.0/21",
		                    "effectiveValue": "87.253.232.0/21",
		                    "subnetCount": 2046,
		                    "subnetBits": 11
		                },
		                {
		                    "id": 25,
		                    "qualifier": "+",
		                    "mechanism": "ip4",
		                    "value": "185.189.236.0/22",
		                    "effectiveValue": "185.189.236.0/22",
		                    "subnetCount": 1022,
		                    "subnetBits": 10
		                },
		                {
		                    "id": 26,
		                    "qualifier": "?",
		                    "mechanism": "all"
		                }
		            ],
		            "rfc4408DnsCount": 1,
		            "rfc7208DnsCount": 1,
		            "errors": [
		                {
		                    "error": "spf-unexpected-result-neutral"
		                }
		            ]
		        },
		        {
		            "id": 27,
		            "qualifier": "+",
		            "mechanism": "include",
		            "value": "servers.mcsv.net",
		            "effectiveValue": "servers.mcsv.net.",
		            "raw": "v=spf1 ip4:205.201.128.0/20 ip4:198.2.128.0/18 ip4:148.105.8.0/21 ?all",
		            "children": [
		                {
		                    "id": 28,
		                    "qualifier": "+",
		                    "mechanism": "ip4",
		                    "value": "205.201.128.0/20",
		                    "effectiveValue": "205.201.128.0/20",
		                    "subnetCount": 4094,
		                    "subnetBits": 12
		                },
		                {
		                    "id": 29,
		                    "qualifier": "+",
		                    "mechanism": "ip4",
		                    "value": "198.2.128.0/18",
		                    "effectiveValue": "198.2.128.0/18",
		                    "subnetCount": 16382,
		                    "subnetBits": 14
		                },
		                {
		                    "id": 30,
		                    "qualifier": "+",
		                    "mechanism": "ip4",
		                    "value": "148.105.8.0/21",
		                    "effectiveValue": "148.105.8.0/21",
		                    "subnetCount": 2046,
		                    "subnetBits": 11
		                },
		                {
		                    "id": 31,
		                    "qualifier": "?",
		                    "mechanism": "all"
		                }
		            ],
		            "rfc4408DnsCount": 1,
		            "rfc7208DnsCount": 1,
		            "errors": [
		                {
		                    "error": "spf-unexpected-result-neutral"
		                }
		            ]
		        },
		        {
		            "id": 32,
		            "qualifier": "+",
		            "mechanism": "ip4",
		            "value": "109.168.127.160/27",
		            "effectiveValue": "109.168.127.160/27",
		            "subnetCount": 30,
		            "subnetBits": 5
		        },
		        {
		            "id": 33,
		            "qualifier": "+",
		            "mechanism": "ip4",
		            "value": "212.31.252.64/27",
		            "effectiveValue": "212.31.252.64/27",
		            "subnetCount": 30,
		            "subnetBits": 5
		        },
		        {
		            "id": 34,
		            "qualifier": "+",
		            "mechanism": "ip4",
		            "value": "212.77.68.6",
		            "effectiveValue": "212.77.68.6",
		            "subnetCount": 1
		        },
		        {
		            "id": 35,
		            "qualifier": "+",
		            "mechanism": "ip4",
		            "value": "62.212.1.160",
		            "effectiveValue": "62.212.1.160",
		            "subnetCount": 1
		        },
		        {
		            "id": 36,
		            "qualifier": "+",
		            "mechanism": "ip4",
		            "value": "62.212.0.160",
		            "effectiveValue": "62.212.0.160",
		            "subnetCount": 1
		        },
		        {
		            "id": 37,
		            "qualifier": "+",
		            "mechanism": "ip4",
		            "value": "93.94.32.0/21",
		            "effectiveValue": "93.94.32.0/21",
		            "subnetCount": 2046,
		            "subnetBits": 11
		        },
		        {
		            "id": 38,
		            "qualifier": "+",
		            "mechanism": "ip4",
		            "value": "93.94.37.253",
		            "effectiveValue": "93.94.37.253",
		            "subnetCount": 1
		        },
		        {
		            "id": 39,
		            "qualifier": "+",
		            "mechanism": "ip4",
		            "value": "109.168.121.48/28",
		            "effectiveValue": "109.168.121.48/28",
		            "subnetCount": 14,
		            "subnetBits": 4
		        },
		        {
		            "id": 40,
		            "qualifier": "+",
		            "mechanism": "ip4",
		            "value": "37.202.20.23/32",
		            "effectiveValue": "37.202.20.23/32",
		            "subnetCount": 1
		        },
		        {
		            "id": 41,
		            "qualifier": "+",
		            "mechanism": "ip4",
		            "value": "213.215.152.254/32",
		            "effectiveValue": "213.215.152.254/32",
		            "subnetCount": 1
		        },
		        {
		            "id": 42,
		            "qualifier": "+",
		            "mechanism": "ip4",
		            "value": "213.215.152.253/32",
		            "effectiveValue": "213.215.152.253/32",
		            "subnetCount": 1
		        },
		        {
		            "id": 43,
		            "qualifier": "+",
		            "mechanism": "ip4",
		            "value": "213.215.152.252/32",
		            "effectiveValue": "213.215.152.252/32",
		            "subnetCount": 1
		        },
		        {
		            "id": 44,
		            "qualifier": "+",
		            "mechanism": "ip4",
		            "value": "213.215.152.251/32",
		            "effectiveValue": "213.215.152.251/32",
		            "subnetCount": 1
		        },
		        {
		            "id": 45,
		            "qualifier": "+",
		            "mechanism": "ip4",
		            "value": "109.168.121.54/32",
		            "effectiveValue": "109.168.121.54/32",
		            "subnetCount": 1
		        },
		        {
		            "id": 46,
		            "qualifier": "+",
		            "mechanism": "ip4",
		            "value": "109.168.121.55/32",
		            "effectiveValue": "109.168.121.55/32",
		            "subnetCount": 1
		        },
		        {
		            "id": 47,
		            "qualifier": "+",
		            "mechanism": "ip4",
		            "value": "109.168.121.57/32",
		            "effectiveValue": "109.168.121.57/32",
		            "subnetCount": 1
		        },
		        {
		            "id": 48,
		            "qualifier": "+",
		            "mechanism": "ip4",
		            "value": "109.168.121.58/32",
		            "effectiveValue": "109.168.121.58/32",
		            "subnetCount": 1
		        },
		        {
		            "id": 49,
		            "qualifier": "-",
		            "mechanism": "all"
		        }
		    ]
		};
const SUBITO_CONNECTIONS =  [
		    {
		        "from": 4,
		        "to": 15,
		        "overlapSubnetBits": 0
		    },
		    {
		        "from": 10,
		        "to": 14,
		        "overlapSubnetBits": 0
		    },
		    {
		        "from": 6,
		        "to": 12,
		        "overlapSubnetBits": 0
		    },
		    {
		        "from": 37,
		        "to": 38,
		        "overlapSubnetBits": 0
		    },
		    {
		        "from": 39,
		        "to": 45,
		        "overlapSubnetBits": 0
		    },
		    {
		        "from": 39,
		        "to": 46,
		        "overlapSubnetBits": 0
		    },
		    {
		        "from": 39,
		        "to": 47,
		        "overlapSubnetBits": 0
		    },
		    {
		        "from": 39,
		        "to": 48,
		        "overlapSubnetBits": 0
		    }
		]
;

  var DUDLEY = {
    "id": 1,
    "raw": "v=spf1 ip4:193.105.48.24 ip4:193.105.48.25 include:spf1.dudley.gov.uk include:spf2.dudley.gov.uk -all",
    "host": "dudley.gov.uk.",
    "children": [
        {
            "id": 2,
            "qualifier": "+",
            "mechanism": "ip4",
            "value": "193.105.48.24",
            "subnetCount": 1
        },
        {
            "id": 3,
            "qualifier": "+",
            "mechanism": "ip4",
            "value": "193.105.48.25",
            "subnetCount": 1
        },
        {
            "id": 4,
            "qualifier": "+",
            "mechanism": "include",
            "value": "spf1.dudley.gov.uk",
            "raw": "v=spf1 ip4:62.209.53.67 ip4:88.208.236.10 ip4:88.208.208.109 ip4:89.16.161.57 ip4:94.136.53.33 ip4:94.136.53.41 ip4:208.89.12.0/22 ip4:212.110.184.247 include:mailcontrol.com include:servers.mcsv.net -all",
            "host": "spf1.dudley.gov.uk.",
            "children": [
                {
                    "id": 5,
                    "qualifier": "+",
                    "mechanism": "ip4",
                    "value": "62.209.53.67",
                    "subnetCount": 1
                },
                {
                    "id": 6,
                    "qualifier": "+",
                    "mechanism": "ip4",
                    "value": "88.208.236.10",
                    "subnetCount": 1
                },
                {
                    "id": 7,
                    "qualifier": "+",
                    "mechanism": "ip4",
                    "value": "88.208.208.109",
                    "subnetCount": 1
                },
                {
                    "id": 8,
                    "qualifier": "+",
                    "mechanism": "ip4",
                    "value": "89.16.161.57",
                    "subnetCount": 1
                },
                {
                    "id": 9,
                    "qualifier": "+",
                    "mechanism": "ip4",
                    "value": "94.136.53.33",
                    "subnetCount": 1
                },
                {
                    "id": 10,
                    "qualifier": "+",
                    "mechanism": "ip4",
                    "value": "94.136.53.41",
                    "subnetCount": 1
                },
                {
                    "id": 11,
                    "qualifier": "+",
                    "mechanism": "ip4",
                    "value": "208.89.12.0/22",
                    "subnetCount": 1024
                },
                {
                    "id": 12,
                    "qualifier": "+",
                    "mechanism": "ip4",
                    "value": "212.110.184.247",
                    "subnetCount": 1
                },
                {
                    "id": 13,
                    "qualifier": "+",
                    "mechanism": "include",
                    "value": "mailcontrol.com",
                    "raw": "v=spf1 ip4:85.115.32.0/19 ip4:86.111.216.0/21 ip4:116.50.56.0/21 ip4:208.87.232.0/21 ip4:196.216.238.0/23 ip4:192.151.176.0/20 ~all",
                    "host": "mailcontrol.com.",
                    "children": [
                        {
                            "id": 14,
                            "qualifier": "+",
                            "mechanism": "ip4",
                            "value": "85.115.32.0/19",
                            "subnetCount": 8192
                        },
                        {
                            "id": 15,
                            "qualifier": "+",
                            "mechanism": "ip4",
                            "value": "86.111.216.0/21",
                            "subnetCount": 2048
                        },
                        {
                            "id": 16,
                            "qualifier": "+",
                            "mechanism": "ip4",
                            "value": "116.50.56.0/21",
                            "subnetCount": 2048
                        },
                        {
                            "id": 17,
                            "qualifier": "+",
                            "mechanism": "ip4",
                            "value": "208.87.232.0/21",
                            "subnetCount": 2048
                        },
                        {
                            "id": 18,
                            "qualifier": "+",
                            "mechanism": "ip4",
                            "value": "196.216.238.0/23",
                            "subnetCount": 512
                        },
                        {
                            "id": 19,
                            "qualifier": "+",
                            "mechanism": "ip4",
                            "value": "192.151.176.0/20",
                            "subnetCount": 4096
                        },
                        {
                            "id": 20,
                            "qualifier": "~",
                            "mechanism": "all"
                        }
                    ],
                    "rfc4408DnsCount": 1,
                    "rfc7208DnsCount": 1
                },
                {
                    "id": 21,
                    "qualifier": "+",
                    "mechanism": "include",
                    "value": "servers.mcsv.net",
                    "raw": "v=spf1 ip4:205.201.128.0/20 ip4:198.2.128.0/18 ip4:148.105.8.0/21 ?all",
                    "host": "servers.mcsv.net.",
                    "children": [
                        {
                            "id": 22,
                            "qualifier": "+",
                            "mechanism": "ip4",
                            "value": "205.201.128.0/20",
                            "subnetCount": 4096
                        },
                        {
                            "id": 23,
                            "qualifier": "+",
                            "mechanism": "ip4",
                            "value": "198.2.128.0/18",
                            "subnetCount": 16384
                        },
                        {
                            "id": 24,
                            "qualifier": "+",
                            "mechanism": "ip4",
                            "value": "148.105.8.0/21",
                            "subnetCount": 2048
                        },
                        {
                            "id": 25,
                            "qualifier": "?",
                            "mechanism": "all"
                        }
                    ],
                    "rfc4408DnsCount": 1,
                    "rfc7208DnsCount": 1
                },
                {
                    "id": 26,
                    "qualifier": "-",
                    "mechanism": "all"
                }
            ],
            "rfc4408DnsCount": 1,
            "rfc7208DnsCount": 1
        },
        {
            "id": 27,
            "qualifier": "+",
            "mechanism": "include",
            "value": "spf2.dudley.gov.uk",
            "raw": "v=spf1 ip4:13.89.43.225 ip4:107.170.253.6 ip4:213.143.150.126 -all",
            "host": "spf2.dudley.gov.uk.",
            "children": [
                {
                    "id": 28,
                    "qualifier": "+",
                    "mechanism": "ip4",
                    "value": "13.89.43.225",
                    "subnetCount": 1
                },
                {
                    "id": 29,
                    "qualifier": "+",
                    "mechanism": "ip4",
                    "value": "107.170.253.6",
                    "subnetCount": 1
                },
                {
                    "id": 30,
                    "qualifier": "+",
                    "mechanism": "ip4",
                    "value": "213.143.150.126",
                    "subnetCount": 1
                },
                {
                    "id": 31,
                    "qualifier": "-",
                    "mechanism": "all"
                }
            ],
            "rfc4408DnsCount": 1,
            "rfc7208DnsCount": 1
        },
        {
            "id": 32,
            "qualifier": "-",
            "mechanism": "all"
        }
    ]
};

var CAMDEN = {
    "id": 1,
    "raw": "v=spf1 include:SPF1.camden.gov.uk include:SPF2.camden.gov.uk include:SPF3.camden.gov.uk -all",
    "host": "camden.gov.uk.",
    "children": [
        {
            "id": 2,
            "qualifier": "+",
            "mechanism": "include",
            "value": "SPF1.camden.gov.uk",
            "raw": "v=spf1 mx a:lbcpay1.bocc.co.uk a:smtp1.rocktimeweb.net a:mail-relay.daisydcs.com -all",
            "host": "spf1.camden.gov.uk.",
            "children": [
                {
                    "id": 3,
                    "qualifier": "+",
                    "mechanism": "mx",
                    "rfc4408DnsCount": 1,
                    "rfc7208DnsCount": 1
                },
                {
                    "id": 4,
                    "qualifier": "+",
                    "mechanism": "a",
                    "value": "lbcpay1.bocc.co.uk",
                    "host": "lbcpay1.bocc.co.uk.",
                    "rfc4408DnsCount": 1,
                    "rfc7208DnsCount": 1
                },
                {
                    "id": 5,
                    "qualifier": "+",
                    "mechanism": "a",
                    "value": "smtp1.rocktimeweb.net",
                    "host": "smtp1.rocktimeweb.net.",
                    "rfc4408DnsCount": 1,
                    "rfc7208DnsCount": 1
                },
                {
                    "id": 6,
                    "qualifier": "+",
                    "mechanism": "a",
                    "value": "mail-relay.daisydcs.com",
                    "host": "mail-relay.daisydcs.com.",
                    "rfc4408DnsCount": 1,
                    "rfc7208DnsCount": 1
                },
                {
                    "id": 7,
                    "qualifier": "-",
                    "mechanism": "all"
                }
            ],
            "rfc4408DnsCount": 1,
            "rfc7208DnsCount": 1
        },
        {
            "id": 8,
            "qualifier": "+",
            "mechanism": "include",
            "value": "SPF2.camden.gov.uk",
            "raw": "v=spf1 ip4:162.13.103.250 ip4:195.191.66.225 ip4:195.191.66.226 ip4:195.191.66.227 ip4:131.124.92.11 -all",
            "host": "spf2.camden.gov.uk.",
            "children": [
                {
                    "id": 9,
                    "qualifier": "+",
                    "mechanism": "ip4",
                    "value": "162.13.103.250",
                    "subnetCount": 1
                },
                {
                    "id": 10,
                    "qualifier": "+",
                    "mechanism": "ip4",
                    "value": "195.191.66.225",
                    "subnetCount": 1
                },
                {
                    "id": 11,
                    "qualifier": "+",
                    "mechanism": "ip4",
                    "value": "195.191.66.226",
                    "subnetCount": 1
                },
                {
                    "id": 12,
                    "qualifier": "+",
                    "mechanism": "ip4",
                    "value": "195.191.66.227",
                    "subnetCount": 1
                },
                {
                    "id": 13,
                    "qualifier": "+",
                    "mechanism": "ip4",
                    "value": "131.124.92.11",
                    "subnetCount": 1
                },
                {
                    "id": 14,
                    "qualifier": "-",
                    "mechanism": "all"
                }
            ],
            "rfc4408DnsCount": 1,
            "rfc7208DnsCount": 1
        },
        {
            "id": 15,
            "qualifier": "+",
            "mechanism": "include",
            "value": "SPF3.camden.gov.uk",
            "raw": "v=spf1 include:spf-0011df01.pphosted.com include:spf.protection.outlook.com include:invalidemail.com include:_netblocks.mimecast.com include:spf_c.oracle.com -all",
            "host": "spf3.camden.gov.uk.",
            "children": [
                {
                    "id": 16,
                    "qualifier": "+",
                    "mechanism": "include",
                    "value": "spf-0011df01.pphosted.com",
                    "raw": "v=spf1 ip4:91.207.212.28 ip4:62.209.51.28",
                    "host": "spf-0011df01.pphosted.com.",
                    "children": [
                        {
                            "id": 17,
                            "qualifier": "+",
                            "mechanism": "ip4",
                            "value": "91.207.212.28",
                            "subnetCount": 1
                        },
                        {
                            "id": 18,
                            "qualifier": "+",
                            "mechanism": "ip4",
                            "value": "62.209.51.28",
                            "subnetCount": 1
                        }
                    ],
                    "rfc4408DnsCount": 1,
                    "rfc7208DnsCount": 1
                },
                {
                    "id": 19,
                    "qualifier": "+",
                    "mechanism": "include",
                    "value": "spf.protection.outlook.com",
                    "raw": "v=spf1 ip4:207.46.101.128/26 ip4:207.46.100.0/24 ip4:207.46.163.0/24 ip4:65.55.169.0/24 ip4:157.56.110.0/23 ip4:157.55.234.0/24 ip4:213.199.154.0/24 ip4:213.199.180.128/26 include:spfa.protection.outlook.com -all",
                    "host": "spf.protection.outlook.com.",
                    "children": [
                        {
                            "id": 20,
                            "qualifier": "+",
                            "mechanism": "ip4",
                            "value": "207.46.101.128/26",
                            "subnetCount": 64
                        },
                        {
                            "id": 21,
                            "qualifier": "+",
                            "mechanism": "ip4",
                            "value": "207.46.100.0/24",
                            "subnetCount": 256
                        },
                        {
                            "id": 22,
                            "qualifier": "+",
                            "mechanism": "ip4",
                            "value": "207.46.163.0/24",
                            "subnetCount": 256
                        },
                        {
                            "id": 23,
                            "qualifier": "+",
                            "mechanism": "ip4",
                            "value": "65.55.169.0/24",
                            "subnetCount": 256
                        },
                        {
                            "id": 24,
                            "qualifier": "+",
                            "mechanism": "ip4",
                            "value": "157.56.110.0/23",
                            "subnetCount": 512
                        },
                        {
                            "id": 25,
                            "qualifier": "+",
                            "mechanism": "ip4",
                            "value": "157.55.234.0/24",
                            "subnetCount": 256
                        },
                        {
                            "id": 26,
                            "qualifier": "+",
                            "mechanism": "ip4",
                            "value": "213.199.154.0/24",
                            "subnetCount": 256
                        },
                        {
                            "id": 27,
                            "qualifier": "+",
                            "mechanism": "ip4",
                            "value": "213.199.180.128/26",
                            "subnetCount": 64
                        },
                        {
                            "id": 28,
                            "qualifier": "+",
                            "mechanism": "include",
                            "value": "spfa.protection.outlook.com",
                            "raw": "v=spf1 ip4:157.56.112.0/24 ip4:207.46.51.64/26 ip4:157.55.158.0/23 ip4:64.4.22.64/26 ip4:40.92.0.0/14 ip4:40.107.0.0/17 ip4:40.107.128.0/17 ip4:134.170.140.0/24 include:spfb.protection.outlook.com ip6:2001:489a:2202::/48 -all",
                            "host": "spfa.protection.outlook.com.",
                            "children": [
                                {
                                    "id": 29,
                                    "qualifier": "+",
                                    "mechanism": "ip4",
                                    "value": "157.56.112.0/24",
                                    "subnetCount": 256
                                },
                                {
                                    "id": 30,
                                    "qualifier": "+",
                                    "mechanism": "ip4",
                                    "value": "207.46.51.64/26",
                                    "subnetCount": 64
                                },
                                {
                                    "id": 31,
                                    "qualifier": "+",
                                    "mechanism": "ip4",
                                    "value": "157.55.158.0/23",
                                    "subnetCount": 512
                                },
                                {
                                    "id": 32,
                                    "qualifier": "+",
                                    "mechanism": "ip4",
                                    "value": "64.4.22.64/26",
                                    "subnetCount": 64
                                },
                                {
                                    "id": 33,
                                    "qualifier": "+",
                                    "mechanism": "ip4",
                                    "value": "40.92.0.0/14",
                                    "subnetCount": 262144
                                },
                                {
                                    "id": 34,
                                    "qualifier": "+",
                                    "mechanism": "ip4",
                                    "value": "40.107.0.0/17",
                                    "subnetCount": 32768
                                },
                                {
                                    "id": 35,
                                    "qualifier": "+",
                                    "mechanism": "ip4",
                                    "value": "40.107.128.0/17",
                                    "subnetCount": 32768
                                },
                                {
                                    "id": 36,
                                    "qualifier": "+",
                                    "mechanism": "ip4",
                                    "value": "134.170.140.0/24",
                                    "subnetCount": 256
                                },
                                {
                                    "id": 37,
                                    "qualifier": "+",
                                    "mechanism": "include",
                                    "value": "spfb.protection.outlook.com",
                                    "raw": "v=spf1 ip6:2a01:111:f400::/48 ip4:23.103.128.0/19 ip4:23.103.198.0/23 ip4:65.55.88.0/24 ip4:104.47.0.0/17 ip4:23.103.200.0/21 ip4:23.103.208.0/21 ip4:23.103.191.0/24 ip4:216.32.180.0/23 ip4:94.245.120.64/26 -all",
                                    "host": "spfb.protection.outlook.com.",
                                    "children": [
                                        {
                                            "id": 38,
                                            "qualifier": "+",
                                            "mechanism": "ip6",
                                            "value": "2a01:111:f400::/48"
                                        },
                                        {
                                            "id": 39,
                                            "qualifier": "+",
                                            "mechanism": "ip4",
                                            "value": "23.103.128.0/19",
                                            "subnetCount": 8192
                                        },
                                        {
                                            "id": 40,
                                            "qualifier": "+",
                                            "mechanism": "ip4",
                                            "value": "23.103.198.0/23",
                                            "subnetCount": 512
                                        },
                                        {
                                            "id": 41,
                                            "qualifier": "+",
                                            "mechanism": "ip4",
                                            "value": "65.55.88.0/24",
                                            "subnetCount": 256
                                        },
                                        {
                                            "id": 42,
                                            "qualifier": "+",
                                            "mechanism": "ip4",
                                            "value": "104.47.0.0/17",
                                            "subnetCount": 32768
                                        },
                                        {
                                            "id": 43,
                                            "qualifier": "+",
                                            "mechanism": "ip4",
                                            "value": "23.103.200.0/21",
                                            "subnetCount": 2048
                                        },
                                        {
                                            "id": 44,
                                            "qualifier": "+",
                                            "mechanism": "ip4",
                                            "value": "23.103.208.0/21",
                                            "subnetCount": 2048
                                        },
                                        {
                                            "id": 45,
                                            "qualifier": "+",
                                            "mechanism": "ip4",
                                            "value": "23.103.191.0/24",
                                            "subnetCount": 256
                                        },
                                        {
                                            "id": 46,
                                            "qualifier": "+",
                                            "mechanism": "ip4",
                                            "value": "216.32.180.0/23",
                                            "subnetCount": 512
                                        },
                                        {
                                            "id": 47,
                                            "qualifier": "+",
                                            "mechanism": "ip4",
                                            "value": "94.245.120.64/26",
                                            "subnetCount": 64
                                        },
                                        {
                                            "id": 48,
                                            "qualifier": "-",
                                            "mechanism": "all"
                                        }
                                    ],
                                    "rfc4408DnsCount": 1,
                                    "rfc7208DnsCount": 1
                                },
                                {
                                    "id": 49,
                                    "qualifier": "+",
                                    "mechanism": "ip6",
                                    "value": "2001:489a:2202::/48"
                                },
                                {
                                    "id": 50,
                                    "qualifier": "-",
                                    "mechanism": "all"
                                }
                            ],
                            "rfc4408DnsCount": 1,
                            "rfc7208DnsCount": 1
                        },
                        {
                            "id": 51,
                            "qualifier": "-",
                            "mechanism": "all"
                        }
                    ],
                    "rfc4408DnsCount": 1,
                    "rfc7208DnsCount": 1
                },
                {
                    "id": 52,
                    "qualifier": "+",
                    "mechanism": "include",
                    "value": "invalidemail.com",
                    "raw": "v=spf1 include:spf_e.invalidemail.com include:spf_l.invalidemail.com include:spf_ldx.invalidemail.com include:spf_gov.invalidemail.com include:spf_amx.invalidemail.com include:spf_syx.invalidemail.com include:spf_amer.invalidemail.com include:spf_emea.invalidemail.com ~all",
                    "host": "invalidemail.com.",
                    "children": [
                        {
                            "id": 53,
                            "qualifier": "+",
                            "mechanism": "include",
                            "value": "spf_e.invalidemail.com",
                            "raw": "v=spf1 ip4:209.34.83.224/30 ip4:67.108.12.41 ip4:67.108.12.38 ip4:67.22.111.164 ip4:72.46.241.47",
                            "host": "spf_e.invalidemail.com.",
                            "children": [
                                {
                                    "id": 54,
                                    "qualifier": "+",
                                    "mechanism": "ip4",
                                    "value": "209.34.83.224/30",
                                    "subnetCount": 4
                                },
                                {
                                    "id": 55,
                                    "qualifier": "+",
                                    "mechanism": "ip4",
                                    "value": "67.108.12.41",
                                    "subnetCount": 1
                                },
                                {
                                    "id": 56,
                                    "qualifier": "+",
                                    "mechanism": "ip4",
                                    "value": "67.108.12.38",
                                    "subnetCount": 1
                                },
                                {
                                    "id": 57,
                                    "qualifier": "+",
                                    "mechanism": "ip4",
                                    "value": "67.22.111.164",
                                    "subnetCount": 1
                                },
                                {
                                    "id": 58,
                                    "qualifier": "+",
                                    "mechanism": "ip4",
                                    "value": "72.46.241.47",
                                    "subnetCount": 1
                                }
                            ],
                            "rfc4408DnsCount": 1,
                            "rfc7208DnsCount": 1
                        },
                        {
                            "id": 59,
                            "qualifier": "+",
                            "mechanism": "include",
                            "value": "spf_l.invalidemail.com",
                            "raw": "v=spf1 ip4:68.233.84.10 ip4:68.233.73.14 ip4:68.233.76.0/23 ip4:68.233.68.0/23 ip4:94.103.23.0/24",
                            "host": "spf_l.invalidemail.com.",
                            "children": [
                                {
                                    "id": 60,
                                    "qualifier": "+",
                                    "mechanism": "ip4",
                                    "value": "68.233.84.10",
                                    "subnetCount": 1
                                },
                                {
                                    "id": 61,
                                    "qualifier": "+",
                                    "mechanism": "ip4",
                                    "value": "68.233.73.14",
                                    "subnetCount": 1
                                },
                                {
                                    "id": 62,
                                    "qualifier": "+",
                                    "mechanism": "ip4",
                                    "value": "68.233.76.0/23",
                                    "subnetCount": 512
                                },
                                {
                                    "id": 63,
                                    "qualifier": "+",
                                    "mechanism": "ip4",
                                    "value": "68.233.68.0/23",
                                    "subnetCount": 512
                                },
                                {
                                    "id": 64,
                                    "qualifier": "+",
                                    "mechanism": "ip4",
                                    "value": "94.103.23.0/24",
                                    "subnetCount": 256
                                }
                            ],
                            "rfc4408DnsCount": 1,
                            "rfc7208DnsCount": 1
                        },
                        {
                            "id": 65,
                            "qualifier": "+",
                            "mechanism": "include",
                            "value": "spf_ldx.invalidemail.com",
                            "raw": "v=spf1 ip4:160.34.64.6 ip4:160.34.64.8 ip4:160.34.64.10 ip4:160.34.64.12 ip4:160.34.64.14 ip4:160.34.64.16 ip4:160.34.64.20 ip4:160.34.64.28",
                            "host": "spf_ldx.invalidemail.com.",
                            "children": [
                                {
                                    "id": 66,
                                    "qualifier": "+",
                                    "mechanism": "ip4",
                                    "value": "160.34.64.6",
                                    "subnetCount": 1
                                },
                                {
                                    "id": 67,
                                    "qualifier": "+",
                                    "mechanism": "ip4",
                                    "value": "160.34.64.8",
                                    "subnetCount": 1
                                },
                                {
                                    "id": 68,
                                    "qualifier": "+",
                                    "mechanism": "ip4",
                                    "value": "160.34.64.10",
                                    "subnetCount": 1
                                },
                                {
                                    "id": 69,
                                    "qualifier": "+",
                                    "mechanism": "ip4",
                                    "value": "160.34.64.12",
                                    "subnetCount": 1
                                },
                                {
                                    "id": 70,
                                    "qualifier": "+",
                                    "mechanism": "ip4",
                                    "value": "160.34.64.14",
                                    "subnetCount": 1
                                },
                                {
                                    "id": 71,
                                    "qualifier": "+",
                                    "mechanism": "ip4",
                                    "value": "160.34.64.16",
                                    "subnetCount": 1
                                },
                                {
                                    "id": 72,
                                    "qualifier": "+",
                                    "mechanism": "ip4",
                                    "value": "160.34.64.20",
                                    "subnetCount": 1
                                },
                                {
                                    "id": 73,
                                    "qualifier": "+",
                                    "mechanism": "ip4",
                                    "value": "160.34.64.28",
                                    "subnetCount": 1
                                }
                            ],
                            "rfc4408DnsCount": 1,
                            "rfc7208DnsCount": 1
                        },
                        {
                            "id": 74,
                            "qualifier": "+",
                            "mechanism": "include",
                            "value": "spf_gov.invalidemail.com",
                            "raw": "v=spf1 ip4:160.34.72.6 ip4:160.34.72.10 ip4:160.34.72.16 ip4:160.34.72.20 ip4:160.34.70.6 ip4:160.34.70.10 ip4:160.34.70.16 ip4:160.34.70.20 ip4:160.34.66.6 ip4:160.34.66.10 ip4:160.34.66.16 ip4:160.34.66.20 ip4:160.34.66.28",
                            "host": "spf_gov.invalidemail.com.",
                            "children": [
                                {
                                    "id": 75,
                                    "qualifier": "+",
                                    "mechanism": "ip4",
                                    "value": "160.34.72.6",
                                    "subnetCount": 1
                                },
                                {
                                    "id": 76,
                                    "qualifier": "+",
                                    "mechanism": "ip4",
                                    "value": "160.34.72.10",
                                    "subnetCount": 1
                                },
                                {
                                    "id": 77,
                                    "qualifier": "+",
                                    "mechanism": "ip4",
                                    "value": "160.34.72.16",
                                    "subnetCount": 1
                                },
                                {
                                    "id": 78,
                                    "qualifier": "+",
                                    "mechanism": "ip4",
                                    "value": "160.34.72.20",
                                    "subnetCount": 1
                                },
                                {
                                    "id": 79,
                                    "qualifier": "+",
                                    "mechanism": "ip4",
                                    "value": "160.34.70.6",
                                    "subnetCount": 1
                                },
                                {
                                    "id": 80,
                                    "qualifier": "+",
                                    "mechanism": "ip4",
                                    "value": "160.34.70.10",
                                    "subnetCount": 1
                                },
                                {
                                    "id": 81,
                                    "qualifier": "+",
                                    "mechanism": "ip4",
                                    "value": "160.34.70.16",
                                    "subnetCount": 1
                                },
                                {
                                    "id": 82,
                                    "qualifier": "+",
                                    "mechanism": "ip4",
                                    "value": "160.34.70.20",
                                    "subnetCount": 1
                                },
                                {
                                    "id": 83,
                                    "qualifier": "+",
                                    "mechanism": "ip4",
                                    "value": "160.34.66.6",
                                    "subnetCount": 1
                                },
                                {
                                    "id": 84,
                                    "qualifier": "+",
                                    "mechanism": "ip4",
                                    "value": "160.34.66.10",
                                    "subnetCount": 1
                                },
                                {
                                    "id": 85,
                                    "qualifier": "+",
                                    "mechanism": "ip4",
                                    "value": "160.34.66.16",
                                    "subnetCount": 1
                                },
                                {
                                    "id": 86,
                                    "qualifier": "+",
                                    "mechanism": "ip4",
                                    "value": "160.34.66.20",
                                    "subnetCount": 1
                                },
                                {
                                    "id": 87,
                                    "qualifier": "+",
                                    "mechanism": "ip4",
                                    "value": "160.34.66.28",
                                    "subnetCount": 1
                                }
                            ],
                            "rfc4408DnsCount": 1,
                            "rfc7208DnsCount": 1
                        },
                        {
                            "id": 88,
                            "qualifier": "+",
                            "mechanism": "include",
                            "value": "spf_amx.invalidemail.com",
                            "raw": "v=spf1 ip4:141.145.4.6 ip4:141.145.4.10 ip4:141.145.4.14 ip4:141.145.4.16 ip4:141.145.4.20 ip4:141.145.4.28",
                            "host": "spf_amx.invalidemail.com.",
                            "children": [
                                {
                                    "id": 89,
                                    "qualifier": "+",
                                    "mechanism": "ip4",
                                    "value": "141.145.4.6",
                                    "subnetCount": 1
                                },
                                {
                                    "id": 90,
                                    "qualifier": "+",
                                    "mechanism": "ip4",
                                    "value": "141.145.4.10",
                                    "subnetCount": 1
                                },
                                {
                                    "id": 91,
                                    "qualifier": "+",
                                    "mechanism": "ip4",
                                    "value": "141.145.4.14",
                                    "subnetCount": 1
                                },
                                {
                                    "id": 92,
                                    "qualifier": "+",
                                    "mechanism": "ip4",
                                    "value": "141.145.4.16",
                                    "subnetCount": 1
                                },
                                {
                                    "id": 93,
                                    "qualifier": "+",
                                    "mechanism": "ip4",
                                    "value": "141.145.4.20",
                                    "subnetCount": 1
                                },
                                {
                                    "id": 94,
                                    "qualifier": "+",
                                    "mechanism": "ip4",
                                    "value": "141.145.4.28",
                                    "subnetCount": 1
                                }
                            ],
                            "rfc4408DnsCount": 1,
                            "rfc7208DnsCount": 1
                        },
                        {
                            "id": 95,
                            "qualifier": "+",
                            "mechanism": "include",
                            "value": "spf_syx.invalidemail.com",
                            "raw": "v=spf1 ip4:160.34.74.6 ip4:160.34.74.10 ip4:160.34.74.14 ip4:160.34.74.16 ip4:160.34.74.20 ip4:160.34.74.28",
                            "host": "spf_syx.invalidemail.com.",
                            "children": [
                                {
                                    "id": 96,
                                    "qualifier": "+",
                                    "mechanism": "ip4",
                                    "value": "160.34.74.6",
                                    "subnetCount": 1
                                },
                                {
                                    "id": 97,
                                    "qualifier": "+",
                                    "mechanism": "ip4",
                                    "value": "160.34.74.10",
                                    "subnetCount": 1
                                },
                                {
                                    "id": 98,
                                    "qualifier": "+",
                                    "mechanism": "ip4",
                                    "value": "160.34.74.14",
                                    "subnetCount": 1
                                },
                                {
                                    "id": 99,
                                    "qualifier": "+",
                                    "mechanism": "ip4",
                                    "value": "160.34.74.16",
                                    "subnetCount": 1
                                },
                                {
                                    "id": 100,
                                    "qualifier": "+",
                                    "mechanism": "ip4",
                                    "value": "160.34.74.20",
                                    "subnetCount": 1
                                },
                                {
                                    "id": 101,
                                    "qualifier": "+",
                                    "mechanism": "ip4",
                                    "value": "160.34.74.28",
                                    "subnetCount": 1
                                }
                            ],
                            "rfc4408DnsCount": 1,
                            "rfc7208DnsCount": 1
                        },
                        {
                            "id": 102,
                            "qualifier": "+",
                            "mechanism": "include",
                            "value": "spf_amer.invalidemail.com",
                            "raw": "v=spf1 ip4:68.233.77.14 ip4:68.233.77.15 ip4:68.233.77.16 ip4:68.233.77.18 ip4:68.233.77.20 ip4:68.233.77.25 ip4:68.233.77.26 ip4:68.233.76.24 ip4:68.233.76.14 ip4:68.233.69.14 ip4:68.233.69.16 ip4:68.233.69.18 ip4:68.233.69.21 ip4:68.233.69.25 ip4:68.233.69.26 ip4:68.233.68.25 ip4:160.34.236.6 ip4:160.34.236.10 ip4:160.34.236.14 ip4:160.34.236.16 ip4:160.34.236.28 ip4:129.91.8.6 ip4:129.91.8.10 ip4:129.91.8.14 ip4:129.91.8.16 ip4:129.91.8.28",
                            "host": "spf_amer.invalidemail.com.",
                            "children": [
                                {
                                    "id": 103,
                                    "qualifier": "+",
                                    "mechanism": "ip4",
                                    "value": "68.233.77.14",
                                    "subnetCount": 1
                                },
                                {
                                    "id": 104,
                                    "qualifier": "+",
                                    "mechanism": "ip4",
                                    "value": "68.233.77.15",
                                    "subnetCount": 1
                                },
                                {
                                    "id": 105,
                                    "qualifier": "+",
                                    "mechanism": "ip4",
                                    "value": "68.233.77.16",
                                    "subnetCount": 1
                                },
                                {
                                    "id": 106,
                                    "qualifier": "+",
                                    "mechanism": "ip4",
                                    "value": "68.233.77.18",
                                    "subnetCount": 1
                                },
                                {
                                    "id": 107,
                                    "qualifier": "+",
                                    "mechanism": "ip4",
                                    "value": "68.233.77.20",
                                    "subnetCount": 1
                                },
                                {
                                    "id": 108,
                                    "qualifier": "+",
                                    "mechanism": "ip4",
                                    "value": "68.233.77.25",
                                    "subnetCount": 1
                                },
                                {
                                    "id": 109,
                                    "qualifier": "+",
                                    "mechanism": "ip4",
                                    "value": "68.233.77.26",
                                    "subnetCount": 1
                                },
                                {
                                    "id": 110,
                                    "qualifier": "+",
                                    "mechanism": "ip4",
                                    "value": "68.233.76.24",
                                    "subnetCount": 1
                                },
                                {
                                    "id": 111,
                                    "qualifier": "+",
                                    "mechanism": "ip4",
                                    "value": "68.233.76.14",
                                    "subnetCount": 1
                                },
                                {
                                    "id": 112,
                                    "qualifier": "+",
                                    "mechanism": "ip4",
                                    "value": "68.233.69.14",
                                    "subnetCount": 1
                                },
                                {
                                    "id": 113,
                                    "qualifier": "+",
                                    "mechanism": "ip4",
                                    "value": "68.233.69.16",
                                    "subnetCount": 1
                                },
                                {
                                    "id": 114,
                                    "qualifier": "+",
                                    "mechanism": "ip4",
                                    "value": "68.233.69.18",
                                    "subnetCount": 1
                                },
                                {
                                    "id": 115,
                                    "qualifier": "+",
                                    "mechanism": "ip4",
                                    "value": "68.233.69.21",
                                    "subnetCount": 1
                                },
                                {
                                    "id": 116,
                                    "qualifier": "+",
                                    "mechanism": "ip4",
                                    "value": "68.233.69.25",
                                    "subnetCount": 1
                                },
                                {
                                    "id": 117,
                                    "qualifier": "+",
                                    "mechanism": "ip4",
                                    "value": "68.233.69.26",
                                    "subnetCount": 1
                                },
                                {
                                    "id": 118,
                                    "qualifier": "+",
                                    "mechanism": "ip4",
                                    "value": "68.233.68.25",
                                    "subnetCount": 1
                                },
                                {
                                    "id": 119,
                                    "qualifier": "+",
                                    "mechanism": "ip4",
                                    "value": "160.34.236.6",
                                    "subnetCount": 1
                                },
                                {
                                    "id": 120,
                                    "qualifier": "+",
                                    "mechanism": "ip4",
                                    "value": "160.34.236.10",
                                    "subnetCount": 1
                                },
                                {
                                    "id": 121,
                                    "qualifier": "+",
                                    "mechanism": "ip4",
                                    "value": "160.34.236.14",
                                    "subnetCount": 1
                                },
                                {
                                    "id": 122,
                                    "qualifier": "+",
                                    "mechanism": "ip4",
                                    "value": "160.34.236.16",
                                    "subnetCount": 1
                                },
                                {
                                    "id": 123,
                                    "qualifier": "+",
                                    "mechanism": "ip4",
                                    "value": "160.34.236.28",
                                    "subnetCount": 1
                                },
                                {
                                    "id": 124,
                                    "qualifier": "+",
                                    "mechanism": "ip4",
                                    "value": "129.91.8.6",
                                    "subnetCount": 1
                                },
                                {
                                    "id": 125,
                                    "qualifier": "+",
                                    "mechanism": "ip4",
                                    "value": "129.91.8.10",
                                    "subnetCount": 1
                                },
                                {
                                    "id": 126,
                                    "qualifier": "+",
                                    "mechanism": "ip4",
                                    "value": "129.91.8.14",
                                    "subnetCount": 1
                                },
                                {
                                    "id": 127,
                                    "qualifier": "+",
                                    "mechanism": "ip4",
                                    "value": "129.91.8.16",
                                    "subnetCount": 1
                                },
                                {
                                    "id": 128,
                                    "qualifier": "+",
                                    "mechanism": "ip4",
                                    "value": "129.91.8.28",
                                    "subnetCount": 1
                                }
                            ],
                            "rfc4408DnsCount": 1,
                            "rfc7208DnsCount": 1
                        },
                        {
                            "id": 129,
                            "qualifier": "+",
                            "mechanism": "include",
                            "value": "spf_emea.invalidemail.com",
                            "raw": "v=spf1 ip4:129.91.56.6 ip4:129.91.56.10 ip4:129.91.56.14 ip4:129.91.56.16 ip4:129.91.56.28 ip4:160.34.220.6 ip4:160.34.220.10 ip4:160.34.220.14 ip4:160.34.220.16 ip4:160.34.220.28 ip4:160.34.204.6 ip4:160.34.204.10 ip4:160.34.204.14 ip4:160.34.204.16 ip4:160.34.204.28",
                            "host": "spf_emea.invalidemail.com.",
                            "children": [
                                {
                                    "id": 130,
                                    "qualifier": "+",
                                    "mechanism": "ip4",
                                    "value": "129.91.56.6",
                                    "subnetCount": 1
                                },
                                {
                                    "id": 131,
                                    "qualifier": "+",
                                    "mechanism": "ip4",
                                    "value": "129.91.56.10",
                                    "subnetCount": 1
                                },
                                {
                                    "id": 132,
                                    "qualifier": "+",
                                    "mechanism": "ip4",
                                    "value": "129.91.56.14",
                                    "subnetCount": 1
                                },
                                {
                                    "id": 133,
                                    "qualifier": "+",
                                    "mechanism": "ip4",
                                    "value": "129.91.56.16",
                                    "subnetCount": 1
                                },
                                {
                                    "id": 134,
                                    "qualifier": "+",
                                    "mechanism": "ip4",
                                    "value": "129.91.56.28",
                                    "subnetCount": 1
                                },
                                {
                                    "id": 135,
                                    "qualifier": "+",
                                    "mechanism": "ip4",
                                    "value": "160.34.220.6",
                                    "subnetCount": 1
                                },
                                {
                                    "id": 136,
                                    "qualifier": "+",
                                    "mechanism": "ip4",
                                    "value": "160.34.220.10",
                                    "subnetCount": 1
                                },
                                {
                                    "id": 137,
                                    "qualifier": "+",
                                    "mechanism": "ip4",
                                    "value": "160.34.220.14",
                                    "subnetCount": 1
                                },
                                {
                                    "id": 138,
                                    "qualifier": "+",
                                    "mechanism": "ip4",
                                    "value": "160.34.220.16",
                                    "subnetCount": 1
                                },
                                {
                                    "id": 139,
                                    "qualifier": "+",
                                    "mechanism": "ip4",
                                    "value": "160.34.220.28",
                                    "subnetCount": 1
                                },
                                {
                                    "id": 140,
                                    "qualifier": "+",
                                    "mechanism": "ip4",
                                    "value": "160.34.204.6",
                                    "subnetCount": 1
                                },
                                {
                                    "id": 141,
                                    "qualifier": "+",
                                    "mechanism": "ip4",
                                    "value": "160.34.204.10",
                                    "subnetCount": 1
                                },
                                {
                                    "id": 142,
                                    "qualifier": "+",
                                    "mechanism": "ip4",
                                    "value": "160.34.204.14",
                                    "subnetCount": 1
                                },
                                {
                                    "id": 143,
                                    "qualifier": "+",
                                    "mechanism": "ip4",
                                    "value": "160.34.204.16",
                                    "subnetCount": 1
                                },
                                {
                                    "id": 144,
                                    "qualifier": "+",
                                    "mechanism": "ip4",
                                    "value": "160.34.204.28",
                                    "subnetCount": 1
                                }
                            ],
                            "rfc4408DnsCount": 1,
                            "rfc7208DnsCount": 1
                        },
                        {
                            "id": 145,
                            "qualifier": "~",
                            "mechanism": "all"
                        }
                    ],
                    "rfc4408DnsCount": 1,
                    "rfc7208DnsCount": 1
                },
                {
                    "id": 146,
                    "qualifier": "+",
                    "mechanism": "include",
                    "value": "_netblocks.mimecast.com",
                    "raw": "v=spf1 include:eu._netblocks.mimecast.com include:us._netblocks.mimecast.com include:za._netblocks.mimecast.com include:au._netblocks.mimecast.com ~all",
                    "host": "_netblocks.mimecast.com.",
                    "children": [
                        {
                            "id": 147,
                            "qualifier": "+",
                            "mechanism": "include",
                            "value": "eu._netblocks.mimecast.com",
                            "raw": "v=spf1 ip4:195.130.217.0/24 ip4:91.220.42.0/24 ip4:146.101.78.0/24 ip4:207.82.80.0/24 ip4:213.167.81.0/24 ip4:213.167.75.0/24 ip4:185.58.84.0/22 ~all",
                            "host": "eu._netblocks.mimecast.com.",
                            "children": [
                                {
                                    "id": 148,
                                    "qualifier": "+",
                                    "mechanism": "ip4",
                                    "value": "195.130.217.0/24",
                                    "subnetCount": 256
                                },
                                {
                                    "id": 149,
                                    "qualifier": "+",
                                    "mechanism": "ip4",
                                    "value": "91.220.42.0/24",
                                    "subnetCount": 256
                                },
                                {
                                    "id": 150,
                                    "qualifier": "+",
                                    "mechanism": "ip4",
                                    "value": "146.101.78.0/24",
                                    "subnetCount": 256
                                },
                                {
                                    "id": 151,
                                    "qualifier": "+",
                                    "mechanism": "ip4",
                                    "value": "207.82.80.0/24",
                                    "subnetCount": 256
                                },
                                {
                                    "id": 152,
                                    "qualifier": "+",
                                    "mechanism": "ip4",
                                    "value": "213.167.81.0/24",
                                    "subnetCount": 256
                                },
                                {
                                    "id": 153,
                                    "qualifier": "+",
                                    "mechanism": "ip4",
                                    "value": "213.167.75.0/24",
                                    "subnetCount": 256
                                },
                                {
                                    "id": 154,
                                    "qualifier": "+",
                                    "mechanism": "ip4",
                                    "value": "185.58.84.0/22",
                                    "subnetCount": 1024
                                },
                                {
                                    "id": 155,
                                    "qualifier": "~",
                                    "mechanism": "all"
                                }
                            ],
                            "rfc4408DnsCount": 1,
                            "rfc7208DnsCount": 1
                        },
                        {
                            "id": 156,
                            "qualifier": "+",
                            "mechanism": "include",
                            "value": "us._netblocks.mimecast.com",
                            "raw": "v=spf1 ip4:207.211.31.0/25 ip4:207.211.30.0/24 ip4:205.139.110.0/23 ip4:216.205.24.0/24 ip4:63.128.21.0/24 ip4:205.217.25.135/32 ip4:205.217.25.132/32 ip4:207.211.41.113/32 ~all",
                            "host": "us._netblocks.mimecast.com.",
                            "children": [
                                {
                                    "id": 157,
                                    "qualifier": "+",
                                    "mechanism": "ip4",
                                    "value": "207.211.31.0/25",
                                    "subnetCount": 128
                                },
                                {
                                    "id": 158,
                                    "qualifier": "+",
                                    "mechanism": "ip4",
                                    "value": "207.211.30.0/24",
                                    "subnetCount": 256
                                },
                                {
                                    "id": 159,
                                    "qualifier": "+",
                                    "mechanism": "ip4",
                                    "value": "205.139.110.0/23",
                                    "subnetCount": 512
                                },
                                {
                                    "id": 160,
                                    "qualifier": "+",
                                    "mechanism": "ip4",
                                    "value": "216.205.24.0/24",
                                    "subnetCount": 256
                                },
                                {
                                    "id": 161,
                                    "qualifier": "+",
                                    "mechanism": "ip4",
                                    "value": "63.128.21.0/24",
                                    "subnetCount": 256
                                },
                                {
                                    "id": 162,
                                    "qualifier": "+",
                                    "mechanism": "ip4",
                                    "value": "205.217.25.135/32",
                                    "subnetCount": 1
                                },
                                {
                                    "id": 163,
                                    "qualifier": "+",
                                    "mechanism": "ip4",
                                    "value": "205.217.25.132/32",
                                    "subnetCount": 1
                                },
                                {
                                    "id": 164,
                                    "qualifier": "+",
                                    "mechanism": "ip4",
                                    "value": "207.211.41.113/32",
                                    "subnetCount": 1
                                },
                                {
                                    "id": 165,
                                    "qualifier": "~",
                                    "mechanism": "all"
                                }
                            ],
                            "rfc4408DnsCount": 1,
                            "rfc7208DnsCount": 1
                        },
                        {
                            "id": 166,
                            "qualifier": "+",
                            "mechanism": "include",
                            "value": "za._netblocks.mimecast.com",
                            "raw": "v=spf1 ip4:41.74.192.0/22 ip4:41.74.200.0/22 ip4:41.74.196.0/22 ip4:41.74.204.0/22 ip4:41.74.201.0/24 ip4:41.74.205.0/24 ip4:41.74.204.3/32 ~all",
                            "host": "za._netblocks.mimecast.com.",
                            "children": [
                                {
                                    "id": 167,
                                    "qualifier": "+",
                                    "mechanism": "ip4",
                                    "value": "41.74.192.0/22",
                                    "subnetCount": 1024
                                },
                                {
                                    "id": 168,
                                    "qualifier": "+",
                                    "mechanism": "ip4",
                                    "value": "41.74.200.0/22",
                                    "subnetCount": 1024
                                },
                                {
                                    "id": 169,
                                    "qualifier": "+",
                                    "mechanism": "ip4",
                                    "value": "41.74.196.0/22",
                                    "subnetCount": 1024
                                },
                                {
                                    "id": 170,
                                    "qualifier": "+",
                                    "mechanism": "ip4",
                                    "value": "41.74.204.0/22",
                                    "subnetCount": 1024
                                },
                                {
                                    "id": 171,
                                    "qualifier": "+",
                                    "mechanism": "ip4",
                                    "value": "41.74.201.0/24",
                                    "subnetCount": 256
                                },
                                {
                                    "id": 172,
                                    "qualifier": "+",
                                    "mechanism": "ip4",
                                    "value": "41.74.205.0/24",
                                    "subnetCount": 256
                                },
                                {
                                    "id": 173,
                                    "qualifier": "+",
                                    "mechanism": "ip4",
                                    "value": "41.74.204.3/32",
                                    "subnetCount": 1
                                },
                                {
                                    "id": 174,
                                    "qualifier": "~",
                                    "mechanism": "all"
                                }
                            ],
                            "rfc4408DnsCount": 1,
                            "rfc7208DnsCount": 1
                        },
                        {
                            "id": 175,
                            "qualifier": "+",
                            "mechanism": "include",
                            "value": "au._netblocks.mimecast.com",
                            "raw": "v=spf1 ip4:103.13.69.0/24 ip4:124.47.150.0/24 ip4:124.47.189.0/24 ip4:180.189.28.0/24 ~all",
                            "host": "au._netblocks.mimecast.com.",
                            "children": [
                                {
                                    "id": 176,
                                    "qualifier": "+",
                                    "mechanism": "ip4",
                                    "value": "103.13.69.0/24",
                                    "subnetCount": 256
                                },
                                {
                                    "id": 177,
                                    "qualifier": "+",
                                    "mechanism": "ip4",
                                    "value": "124.47.150.0/24",
                                    "subnetCount": 256
                                },
                                {
                                    "id": 178,
                                    "qualifier": "+",
                                    "mechanism": "ip4",
                                    "value": "124.47.189.0/24",
                                    "subnetCount": 256
                                },
                                {
                                    "id": 179,
                                    "qualifier": "+",
                                    "mechanism": "ip4",
                                    "value": "180.189.28.0/24",
                                    "subnetCount": 256
                                },
                                {
                                    "id": 180,
                                    "qualifier": "~",
                                    "mechanism": "all"
                                }
                            ],
                            "rfc4408DnsCount": 1,
                            "rfc7208DnsCount": 1
                        },
                        {
                            "id": 181,
                            "qualifier": "~",
                            "mechanism": "all"
                        }
                    ],
                    "rfc4408DnsCount": 1,
                    "rfc7208DnsCount": 1
                },
                {
                    "id": 182,
                    "qualifier": "+",
                    "mechanism": "include",
                    "value": "spf_c.oracle.com",
                    "raw": "v=spf1 ip4:216.131.131.240/28 ip4:143.47.193.160/28 ip4:160.34.31.16/28 ip4:160.34.63.16/28 ip4:160.34.47.16/28 ip4:160.34.15.16/28 ip4:141.145.47.16/28 ip4:141.145.63.16/28 ip4:129.152.95.16/28 ip4:129.152.79.16/28   -all",
                    "host": "spf_c.oracle.com.",
                    "children": [
                        {
                            "id": 183,
                            "qualifier": "+",
                            "mechanism": "ip4",
                            "value": "216.131.131.240/28",
                            "subnetCount": 16
                        },
                        {
                            "id": 184,
                            "qualifier": "+",
                            "mechanism": "ip4",
                            "value": "143.47.193.160/28",
                            "subnetCount": 16
                        },
                        {
                            "id": 185,
                            "qualifier": "+",
                            "mechanism": "ip4",
                            "value": "160.34.31.16/28",
                            "subnetCount": 16
                        },
                        {
                            "id": 186,
                            "qualifier": "+",
                            "mechanism": "ip4",
                            "value": "160.34.63.16/28",
                            "subnetCount": 16
                        },
                        {
                            "id": 187,
                            "qualifier": "+",
                            "mechanism": "ip4",
                            "value": "160.34.47.16/28",
                            "subnetCount": 16
                        },
                        {
                            "id": 188,
                            "qualifier": "+",
                            "mechanism": "ip4",
                            "value": "160.34.15.16/28",
                            "subnetCount": 16
                        },
                        {
                            "id": 189,
                            "qualifier": "+",
                            "mechanism": "ip4",
                            "value": "141.145.47.16/28",
                            "subnetCount": 16
                        },
                        {
                            "id": 190,
                            "qualifier": "+",
                            "mechanism": "ip4",
                            "value": "141.145.63.16/28",
                            "subnetCount": 16
                        },
                        {
                            "id": 191,
                            "qualifier": "+",
                            "mechanism": "ip4",
                            "value": "129.152.95.16/28",
                            "subnetCount": 16
                        },
                        {
                            "id": 192,
                            "qualifier": "+",
                            "mechanism": "ip4",
                            "value": "129.152.79.16/28",
                            "subnetCount": 16
                        },
                        {
                            "id": 193,
                            "qualifier": "-",
                            "mechanism": "all"
                        }
                    ],
                    "rfc4408DnsCount": 1,
                    "rfc7208DnsCount": 1
                },
                {
                    "id": 194,
                    "qualifier": "-",
                    "mechanism": "all"
                }
            ],
            "rfc4408DnsCount": 1,
            "rfc7208DnsCount": 1
        },
        {
            "id": 195,
            "qualifier": "-",
            "mechanism": "all"
        }
    ]
}

var CITY = {
		    "id": 1,
		    "effectiveValue": "city.ac.uk.",
		    "raw": "v=spf1 include:spf.protection.outlook.com include:spf.messagelabs.com include:spf.city.ac.uk ip4:213.206.140.0/22 ip4:82.195.160.0/22 ~all",
		    "children": [
		        {
		            "id": 2,
		            "qualifier": "+",
		            "mechanism": "include",
		            "value": "spf.protection.outlook.com",
		            "effectiveValue": "spf.protection.outlook.com.",
		            "raw": "v=spf1 ip4:207.46.101.128/26 ip4:207.46.100.0/24 ip4:207.46.163.0/24 ip4:65.55.169.0/24 ip4:157.56.110.0/23 ip4:157.55.234.0/24 ip4:213.199.154.0/24 ip4:213.199.180.128/26 include:spfa.protection.outlook.com -all",
		            "children": [
		                {
		                    "id": 3,
		                    "qualifier": "+",
		                    "mechanism": "ip4",
		                    "value": "207.46.101.128/26",
		                    "effectiveValue": "207.46.101.128/26",
		                    "subnetCount": 62,
		                    "subnetBits": 6
		                },
		                {
		                    "id": 4,
		                    "qualifier": "+",
		                    "mechanism": "ip4",
		                    "value": "207.46.100.0/24",
		                    "effectiveValue": "207.46.100.0/24",
		                    "subnetCount": 254,
		                    "subnetBits": 8
		                },
		                {
		                    "id": 5,
		                    "qualifier": "+",
		                    "mechanism": "ip4",
		                    "value": "207.46.163.0/24",
		                    "effectiveValue": "207.46.163.0/24",
		                    "subnetCount": 254,
		                    "subnetBits": 8
		                },
		                {
		                    "id": 6,
		                    "qualifier": "+",
		                    "mechanism": "ip4",
		                    "value": "65.55.169.0/24",
		                    "effectiveValue": "65.55.169.0/24",
		                    "subnetCount": 254,
		                    "subnetBits": 8
		                },
		                {
		                    "id": 7,
		                    "qualifier": "+",
		                    "mechanism": "ip4",
		                    "value": "157.56.110.0/23",
		                    "effectiveValue": "157.56.110.0/23",
		                    "subnetCount": 510,
		                    "subnetBits": 9
		                },
		                {
		                    "id": 8,
		                    "qualifier": "+",
		                    "mechanism": "ip4",
		                    "value": "157.55.234.0/24",
		                    "effectiveValue": "157.55.234.0/24",
		                    "subnetCount": 254,
		                    "subnetBits": 8
		                },
		                {
		                    "id": 9,
		                    "qualifier": "+",
		                    "mechanism": "ip4",
		                    "value": "213.199.154.0/24",
		                    "effectiveValue": "213.199.154.0/24",
		                    "subnetCount": 254,
		                    "subnetBits": 8
		                },
		                {
		                    "id": 10,
		                    "qualifier": "+",
		                    "mechanism": "ip4",
		                    "value": "213.199.180.128/26",
		                    "effectiveValue": "213.199.180.128/26",
		                    "subnetCount": 62,
		                    "subnetBits": 6
		                },
		                {
		                    "id": 11,
		                    "qualifier": "+",
		                    "mechanism": "include",
		                    "value": "spfa.protection.outlook.com",
		                    "effectiveValue": "spfa.protection.outlook.com.",
		                    "raw": "v=spf1 ip4:157.56.112.0/24 ip4:207.46.51.64/26 ip4:157.55.158.0/23 ip4:64.4.22.64/26 ip4:40.92.0.0/14 ip4:40.107.0.0/17 ip4:40.107.128.0/17 ip4:134.170.140.0/24 include:spfb.protection.outlook.com ip6:2001:489a:2202::/48 -all",
		                    "children": [
		                        {
		                            "id": 12,
		                            "qualifier": "+",
		                            "mechanism": "ip4",
		                            "value": "157.56.112.0/24",
		                            "effectiveValue": "157.56.112.0/24",
		                            "subnetCount": 254,
		                            "subnetBits": 8
		                        },
		                        {
		                            "id": 13,
		                            "qualifier": "+",
		                            "mechanism": "ip4",
		                            "value": "207.46.51.64/26",
		                            "effectiveValue": "207.46.51.64/26",
		                            "subnetCount": 62,
		                            "subnetBits": 6
		                        },
		                        {
		                            "id": 14,
		                            "qualifier": "+",
		                            "mechanism": "ip4",
		                            "value": "157.55.158.0/23",
		                            "effectiveValue": "157.55.158.0/23",
		                            "subnetCount": 510,
		                            "subnetBits": 9
		                        },
		                        {
		                            "id": 15,
		                            "qualifier": "+",
		                            "mechanism": "ip4",
		                            "value": "64.4.22.64/26",
		                            "effectiveValue": "64.4.22.64/26",
		                            "subnetCount": 62,
		                            "subnetBits": 6
		                        },
		                        {
		                            "id": 16,
		                            "qualifier": "+",
		                            "mechanism": "ip4",
		                            "value": "40.92.0.0/14",
		                            "effectiveValue": "40.92.0.0/14",
		                            "subnetCount": 262142,
		                            "subnetBits": 18
		                        },
		                        {
		                            "id": 17,
		                            "qualifier": "+",
		                            "mechanism": "ip4",
		                            "value": "40.107.0.0/17",
		                            "effectiveValue": "40.107.0.0/17",
		                            "subnetCount": 32766,
		                            "subnetBits": 15
		                        },
		                        {
		                            "id": 18,
		                            "qualifier": "+",
		                            "mechanism": "ip4",
		                            "value": "40.107.128.0/17",
		                            "effectiveValue": "40.107.128.0/17",
		                            "subnetCount": 32766,
		                            "subnetBits": 15
		                        },
		                        {
		                            "id": 19,
		                            "qualifier": "+",
		                            "mechanism": "ip4",
		                            "value": "134.170.140.0/24",
		                            "effectiveValue": "134.170.140.0/24",
		                            "subnetCount": 254,
		                            "subnetBits": 8
		                        },
		                        {
		                            "id": 20,
		                            "qualifier": "+",
		                            "mechanism": "include",
		                            "value": "spfb.protection.outlook.com",
		                            "effectiveValue": "spfb.protection.outlook.com.",
		                            "raw": "v=spf1 ip6:2a01:111:f400::/48 ip4:23.103.128.0/19 ip4:23.103.198.0/23 ip4:65.55.88.0/24 ip4:104.47.0.0/17 ip4:23.103.200.0/21 ip4:23.103.208.0/21 ip4:23.103.191.0/24 ip4:216.32.180.0/23 ip4:94.245.120.64/26 -all",
		                            "children": [
		                                {
		                                    "id": 21,
		                                    "qualifier": "+",
		                                    "mechanism": "ip6",
		                                    "value": "2a01:111:f400::/48",
		                                    "effectiveValue": "2a01:111:f400::/48",
		                                    "subnetCount": 18446744073709551615,
		                                    "subnetBits": 80
		                                },
		                                {
		                                    "id": 22,
		                                    "qualifier": "+",
		                                    "mechanism": "ip4",
		                                    "value": "23.103.128.0/19",
		                                    "effectiveValue": "23.103.128.0/19",
		                                    "subnetCount": 8190,
		                                    "subnetBits": 13
		                                },
		                                {
		                                    "id": 23,
		                                    "qualifier": "+",
		                                    "mechanism": "ip4",
		                                    "value": "23.103.198.0/23",
		                                    "effectiveValue": "23.103.198.0/23",
		                                    "subnetCount": 510,
		                                    "subnetBits": 9
		                                },
		                                {
		                                    "id": 24,
		                                    "qualifier": "+",
		                                    "mechanism": "ip4",
		                                    "value": "65.55.88.0/24",
		                                    "effectiveValue": "65.55.88.0/24",
		                                    "subnetCount": 254,
		                                    "subnetBits": 8
		                                },
		                                {
		                                    "id": 25,
		                                    "qualifier": "+",
		                                    "mechanism": "ip4",
		                                    "value": "104.47.0.0/17",
		                                    "effectiveValue": "104.47.0.0/17",
		                                    "subnetCount": 32766,
		                                    "subnetBits": 15
		                                },
		                                {
		                                    "id": 26,
		                                    "qualifier": "+",
		                                    "mechanism": "ip4",
		                                    "value": "23.103.200.0/21",
		                                    "effectiveValue": "23.103.200.0/21",
		                                    "subnetCount": 2046,
		                                    "subnetBits": 11
		                                },
		                                {
		                                    "id": 27,
		                                    "qualifier": "+",
		                                    "mechanism": "ip4",
		                                    "value": "23.103.208.0/21",
		                                    "effectiveValue": "23.103.208.0/21",
		                                    "subnetCount": 2046,
		                                    "subnetBits": 11
		                                },
		                                {
		                                    "id": 28,
		                                    "qualifier": "+",
		                                    "mechanism": "ip4",
		                                    "value": "23.103.191.0/24",
		                                    "effectiveValue": "23.103.191.0/24",
		                                    "subnetCount": 254,
		                                    "subnetBits": 8
		                                },
		                                {
		                                    "id": 29,
		                                    "qualifier": "+",
		                                    "mechanism": "ip4",
		                                    "value": "216.32.180.0/23",
		                                    "effectiveValue": "216.32.180.0/23",
		                                    "subnetCount": 510,
		                                    "subnetBits": 9
		                                },
		                                {
		                                    "id": 30,
		                                    "qualifier": "+",
		                                    "mechanism": "ip4",
		                                    "value": "94.245.120.64/26",
		                                    "effectiveValue": "94.245.120.64/26",
		                                    "subnetCount": 62,
		                                    "subnetBits": 6
		                                },
		                                {
		                                    "id": 31,
		                                    "qualifier": "-",
		                                    "mechanism": "all"
		                                }
		                            ],
		                            "rfc4408DnsCount": 1,
		                            "rfc7208DnsCount": 1
		                        },
		                        {
		                            "id": 32,
		                            "qualifier": "+",
		                            "mechanism": "ip6",
		                            "value": "2001:489a:2202::/48",
		                            "effectiveValue": "2001:489a:2202::/48",
		                            "subnetCount": 18446744073709551615,
		                            "subnetBits": 80
		                        },
		                        {
		                            "id": 33,
		                            "qualifier": "-",
		                            "mechanism": "all"
		                        }
		                    ],
		                    "rfc4408DnsCount": 1,
		                    "rfc7208DnsCount": 1
		                },
		                {
		                    "id": 34,
		                    "qualifier": "-",
		                    "mechanism": "all"
		                }
		            ],
		            "rfc4408DnsCount": 1,
		            "rfc7208DnsCount": 1
		        },
		        {
		            "id": 35,
		            "qualifier": "+",
		            "mechanism": "include",
		            "value": "spf.messagelabs.com",
		            "effectiveValue": "spf.messagelabs.com.",
		            "raw": "v=spf1 include:nets1.spf.messagelabs.com include:nets2.spf.messagelabs.com ~all",
		            "children": [
		                {
		                    "id": 36,
		                    "qualifier": "+",
		                    "mechanism": "include",
		                    "value": "nets1.spf.messagelabs.com",
		                    "effectiveValue": "nets1.spf.messagelabs.com.",
		                    "raw": "v=spf1 ip4:85.158.136.0/21 ip4:193.109.254.0/23 ip4:194.106.220.0/23 ip4:195.245.230.0/23 ip4:95.131.104.0/21 ip4:46.226.48.0/21 ip4:196.14.170.0/23",
		                    "children": [
		                        {
		                            "id": 37,
		                            "qualifier": "+",
		                            "mechanism": "ip4",
		                            "value": "85.158.136.0/21",
		                            "effectiveValue": "85.158.136.0/21",
		                            "subnetCount": 2046,
		                            "subnetBits": 11
		                        },
		                        {
		                            "id": 38,
		                            "qualifier": "+",
		                            "mechanism": "ip4",
		                            "value": "193.109.254.0/23",
		                            "effectiveValue": "193.109.254.0/23",
		                            "subnetCount": 510,
		                            "subnetBits": 9
		                        },
		                        {
		                            "id": 39,
		                            "qualifier": "+",
		                            "mechanism": "ip4",
		                            "value": "194.106.220.0/23",
		                            "effectiveValue": "194.106.220.0/23",
		                            "subnetCount": 510,
		                            "subnetBits": 9
		                        },
		                        {
		                            "id": 40,
		                            "qualifier": "+",
		                            "mechanism": "ip4",
		                            "value": "195.245.230.0/23",
		                            "effectiveValue": "195.245.230.0/23",
		                            "subnetCount": 510,
		                            "subnetBits": 9
		                        },
		                        {
		                            "id": 41,
		                            "qualifier": "+",
		                            "mechanism": "ip4",
		                            "value": "95.131.104.0/21",
		                            "effectiveValue": "95.131.104.0/21",
		                            "subnetCount": 2046,
		                            "subnetBits": 11
		                        },
		                        {
		                            "id": 42,
		                            "qualifier": "+",
		                            "mechanism": "ip4",
		                            "value": "46.226.48.0/21",
		                            "effectiveValue": "46.226.48.0/21",
		                            "subnetCount": 2046,
		                            "subnetBits": 11
		                        },
		                        {
		                            "id": 43,
		                            "qualifier": "+",
		                            "mechanism": "ip4",
		                            "value": "196.14.170.0/23",
		                            "effectiveValue": "196.14.170.0/23",
		                            "subnetCount": 510,
		                            "subnetBits": 9
		                        }
		                    ],
		                    "rfc4408DnsCount": 1,
		                    "rfc7208DnsCount": 1,
		                    "errors": [
		                        {
		                            "error": "spf-unexpected-result-neutral"
		                        }
		                    ]
		                },
		                {
		                    "id": 44,
		                    "qualifier": "+",
		                    "mechanism": "include",
		                    "value": "nets2.spf.messagelabs.com",
		                    "effectiveValue": "nets2.spf.messagelabs.com.",
		                    "raw": "v=spf1 ip4:216.82.240.0/20 ip4:67.219.240.0/20 ip4:117.120.16.0/21 ip4:103.9.96.0/22",
		                    "children": [
		                        {
		                            "id": 45,
		                            "qualifier": "+",
		                            "mechanism": "ip4",
		                            "value": "216.82.240.0/20",
		                            "effectiveValue": "216.82.240.0/20",
		                            "subnetCount": 4094,
		                            "subnetBits": 12
		                        },
		                        {
		                            "id": 46,
		                            "qualifier": "+",
		                            "mechanism": "ip4",
		                            "value": "67.219.240.0/20",
		                            "effectiveValue": "67.219.240.0/20",
		                            "subnetCount": 4094,
		                            "subnetBits": 12
		                        },
		                        {
		                            "id": 47,
		                            "qualifier": "+",
		                            "mechanism": "ip4",
		                            "value": "117.120.16.0/21",
		                            "effectiveValue": "117.120.16.0/21",
		                            "subnetCount": 2046,
		                            "subnetBits": 11
		                        },
		                        {
		                            "id": 48,
		                            "qualifier": "+",
		                            "mechanism": "ip4",
		                            "value": "103.9.96.0/22",
		                            "effectiveValue": "103.9.96.0/22",
		                            "subnetCount": 1022,
		                            "subnetBits": 10
		                        }
		                    ],
		                    "rfc4408DnsCount": 1,
		                    "rfc7208DnsCount": 1,
		                    "errors": [
		                        {
		                            "error": "spf-unexpected-result-neutral"
		                        }
		                    ]
		                },
		                {
		                    "id": 49,
		                    "qualifier": "~",
		                    "mechanism": "all"
		                }
		            ],
		            "rfc4408DnsCount": 1,
		            "rfc7208DnsCount": 1
		        },
		        {
		            "id": 50,
		            "qualifier": "+",
		            "mechanism": "include",
		            "value": "spf.city.ac.uk",
		            "effectiveValue": "spf.city.ac.uk.",
		            "raw": "v=spf1 ip4:138.40.77.122 ip4:138.40.77.123 ip4:138.40.77.124 ip4:138.40.77.125 ip4:138.40.65.148 ip4:138.40.65.149 ~all",
		            "children": [
		                {
		                    "id": 51,
		                    "qualifier": "+",
		                    "mechanism": "ip4",
		                    "value": "138.40.77.122",
		                    "effectiveValue": "138.40.77.122",
		                    "subnetCount": 1
		                },
		                {
		                    "id": 52,
		                    "qualifier": "+",
		                    "mechanism": "ip4",
		                    "value": "138.40.77.123",
		                    "effectiveValue": "138.40.77.123",
		                    "subnetCount": 1
		                },
		                {
		                    "id": 53,
		                    "qualifier": "+",
		                    "mechanism": "ip4",
		                    "value": "138.40.77.124",
		                    "effectiveValue": "138.40.77.124",
		                    "subnetCount": 1
		                },
		                {
		                    "id": 54,
		                    "qualifier": "+",
		                    "mechanism": "ip4",
		                    "value": "138.40.77.125",
		                    "effectiveValue": "138.40.77.125",
		                    "subnetCount": 1
		                },
		                {
		                    "id": 55,
		                    "qualifier": "+",
		                    "mechanism": "ip4",
		                    "value": "138.40.65.148",
		                    "effectiveValue": "138.40.65.148",
		                    "subnetCount": 1
		                },
		                {
		                    "id": 56,
		                    "qualifier": "+",
		                    "mechanism": "ip4",
		                    "value": "138.40.65.149",
		                    "effectiveValue": "138.40.65.149",
		                    "subnetCount": 1
		                },
		                {
		                    "id": 57,
		                    "qualifier": "~",
		                    "mechanism": "all"
		                }
		            ],
		            "rfc4408DnsCount": 1,
		            "rfc7208DnsCount": 1
		        },
		        {
		            "id": 58,
		            "qualifier": "+",
		            "mechanism": "ip4",
		            "value": "213.206.140.0/22",
		            "effectiveValue": "213.206.140.0/22",
		            "subnetCount": 1022,
		            "subnetBits": 10
		        },
		        {
		            "id": 59,
		            "qualifier": "+",
		            "mechanism": "ip4",
		            "value": "82.195.160.0/22",
		            "effectiveValue": "82.195.160.0/22",
		            "subnetCount": 1022,
		            "subnetBits": 10
		        },
		        {
		            "id": 60,
		            "qualifier": "~",
		            "mechanism": "all"
		        }
		    ]
		}

    var triangle = d3.symbol().type(d3.symbolTriangle);
    var circle = d3.symbol().type(d3.symbolCircle);

    function qualifierString(q) {
      if (q === '+') {
        return 'Pass';
      } else if (q === '-') {
        return 'Fail';
      } else if (q === '~') {
        return 'Softfail';
      } else if (q === '?') {
        return 'Neutral';
      } else {
        return 'Unknown';
      }
    }

    function label(d) {
      if (d.data.mechanism === 'all') {
        return qualifierString(d.data.qualifier);
      }
      var value = d.data.value ? d.data.value : d.data.effectiveValue ? d.data.effectiveValue : '';

      return (d.data.mechanism ? d.data.mechanism + ': ' : value === '' ? '?' : '') + value;
    }

    function hasError(d) {
        return d.data.errors && d.data.errors.length > 0;
    }

    function toolTipForNode(d) {
        return `<div>${d.value}</div><div>Something</div>`;
    }
    
    function toolTipForConnecion(d) {
        return `<div>${d.from}</div><div>${d.to}</div>`;
    }

    var triangle = d3.symbol().type(d3.symbolTriangle);
    var circle = d3.symbol().type(d3.symbolCircle);

    var fieldFn = null;
    var theme = 'light';
    var tree = d3_rs_tree.html('flare')
                    .theme(theme)
                    .label(label)
                    .nodeRadius([6, 20])
                    .badge(function (d) {
                        return fieldFn(d);
                    })
                    .nodeFill(function (d) {
                        if (hasError(d)) {
                            return 'red';
                        }
                        if (d.hasChildren) {
                            return 'green';
                        }
                        return null;
                    })
                    .nodeSymbol(function (d) { 
                        return hasError(d) ? triangle : circle
                    })
                    .nameClass(function (d) {
                      return d.hasChildren ? 'default' : 'ip-addr';
                    })
                    .tipHtml(function (d) {
                        if (d.data) {
                            return toolTipForNode(d.data);
                        }
                        return toolTipForConnecion(d);
                    });
    
    var THEME = {
        defaut: '#28AA64',
        colors: [ '#D776AE', '#A580D7', '#67ACDE', '#F1952D' ]
    };

    var dataSet = CITY;
    dataSet.connections = SUBITO_CONNECTIONS;
    var data = d3_rs_tree.mapChildren(dataSet, label);
    sortDefault();
    //data.collapse(1);

    function update(animated) {
      var svg = d3.select('#elm').datum(data);
      if (animated) 
      {
        svg = svg.transition().duration(666);
      }  
      svg.call(tree);
    }

    tree.onClick(function (d) {
      if (d.children) {
        d._children = d.children;
        d.children = null;
      } else {
        d.children = d._children;
        d._children = null;
      }
      update(true);
    });

    update(false);

    // -- buttons

    function doCollapse() {
      data = data.collapse();
      update(true);
    }

    function doExpand() {
      data = data.expand();
      update(true);
    }

    function doCollapseDecrement() {
      for (var i = data.height; i >= 0; i--) {
        var c = data.countDepth(i, function(d) { return 1 })
        if (c !== 0) {
          i--;
          break; // close this level
        }
      }
      data = data.collapse(i);
      update(true);
    }

    function doExpandIncrement() {
      for (var i = 0; i < data.height; i++) {
        var c = data.countDepth(i, function(d) { return d.hasChildren })
        if (c === 0) break; // nothing to contine on

        var o = data.countDepth(i, function(d) { return d.children })
        if (o === 0 || c !== o) {
          i++; // open next level, nothing or some are open
          break; 
        }

        // has children, all open, continue
      }
      data = data.expand(i);
      update(true);
    }

    function sortDefault() {
      var state = data.getOpenState();
      fieldFn = function (d) { return null; };
      
      data.expand()
          .sum(function (d) { return 0; })
          .scale()
          .sort(function(a, b) { return a.id - b.id; })
          .sum(function (d) { 
            return d.children ? d.children.length + 1 : 1
          })
          .scale()
          .openState(state);
    }

    function doSortId() {
      sortDefault();
      update(true);
    }

    function doSort(field) {
      var state = data.getOpenState();
      const fmt = d3.format(',.0f')

      fieldFn = function (d) { return d.value ? d.value > 99999 ? '~ 2^' + fmt(Math.sqrt(d.value)) : fmt(d.value) : null; };

      data.expand()
          .sum(function (d) { return d[field]; })
          .scale()
          .sort(function(a, b) { return b.value - a.value || a.id - b.id; })
          .openState(state);

      update(true);
    }

    </script>
  </body>
</html>
